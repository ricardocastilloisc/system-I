<div class="container-fluid" *ngIf="DataUser$ | async as DataUser">
    <div
      class="flex-row-reverse justify-content-center"
      style="height: 50vh; width: 100%"
    >
    <div class="row justify-content-center">
      
      
      <div class="titulo-proceso">{{rutaActiva.snapshot.params.id}}</div>
  
    </div>

    <!-- <div class="row justify-content-center container-referencias-log"  >
        <div class=" d-flex col-md-2 col-xs-3 col-sm-3 col-lg-3 mr-3 col-3 align-items-center justify-content-center" style="height: 45px;">
            <a >Ver logs</a>
            

        
        </div>
        <div class=" d-flex col-md-3 col-xs-3 col-sm-3 col-lg-3 mr-3 col-3 align-items-center justify-content-center" style="height: 45px;">
            <a >Ver logs</a>
        </div>
        <div class=" d-flex col-md-3 col-xs-3 col-sm-3 col-lg-3 mr-3 col-3 align-items-center justify-content-center" style="height: 45px;">
            <a >Ver logs</a>
        </div>

    </div> -->


    <!-- <div [ngClass]="{'show-ejecuciones': mostrarEjecucionesProcesos == true, 'hide-ejecuciones': mostrarEjecucionesProcesos == false}" class="row justify-content-center hide-div ">
        <div class="d-flex col-md-9 col-xs-9 col-sm-9 col-lg-9 mr-9 col-9 align-items-center justify-content-center" >
            <div class="show-info">
            </div>
            <span *ngIf="mostrarEjecucionesProcesos" class="show-info-button" (click)="mostrarEjecucionesProcesos = !mostrarEjecucionesProcesos">Ocultar Ejecuciones</span>
        </div>
        
    </div> -->

    <div class="row justify-content-center container-referencias-log" [ngClass]="{'show-ejecuciones': mostrarEjecucionesProcesos == true, 'hide-ejecuciones': mostrarEjecucionesProcesos == false}" *ngIf="AUDGENESTADOPROCESOS$ | async as AUDGENESTADOPROCESOS"  >
        <div class="d-flex col-md-12 col-sm-12 col-xs-12 col-lg-12 col-xl-6 justify-content-center">


            <div class="card-calendario">
            <div>Selecciona una fecha</div>
            <div>
                <input type="date" placeholder="Selecciona una fecha" [(ngModel)]="inputFecha" />
            </div>
            <div>
                <!--
                <select name="cars" id="cars" value="Estado">
                    <option disabled selected>Estado</option>
                    <option value="iniciado">En proceso</option>
                    <option value="detenido">Detenido</option>
    
                </select>
                -->
            </div>
            <div><button>Buscar</button></div>
            </div>
  
  
      </div>
    
        <div class="d-flex col-md-9 col-xs-9 col-sm-9 col-lg-9 mr-9 col-9 align-items-left justify-content-left ">
            <span class="title-log-table">Listado de ejecuciones</span>
        </div>
        <div class="d-flex col-md-9 col-xs-9 col-sm-9 col-lg-9 mr-9 col-9 align-items-center justify-content-center" >
            <table class="listado-log listado-ejecuciones" >
                
                <thead>
                    <tr>
                        <th>ID Ejecucion</th>
                        <th>Hora</th>
                        <th colspan="12" >Resultado ejecuci√≥n</th>
                    </tr>
                </thead>
                <tbody>
                    
                    
                        <tr *ngFor="let AUDGENESTADOPROCESO of AUDGENESTADOPROCESOS | paginate: {id: 'ejecucionesProceso', itemsPerPage: 10, currentPage: paginaActualEjecucionesProceso} ; index as i" class='clickable' (click)="consultarDetalle(AUDGENESTADOPROCESO.ID_PROCESO)" >
                            
                            <td >{{AUDGENESTADOPROCESO.ID_PROCESO}}</td>
                            <td >{{AUDGENESTADOPROCESO.FECHA_ACTUALIZACION | date :'short'}}</td>
                            <td [ngClass]="{'error-log': AUDGENESTADOPROCESO.ESTADO == 'FALLIDO'}">{{AUDGENESTADOPROCESO.ESTADO}}</td>

                        </tr>
                    
                </tbody>
                
              </table>

        </div>
        <div class="d-flex col-md-9 col-xs-9 col-sm-9 col-lg-9 mr-9 col-9 align-items-left ">
            <pagination-template id="ejecucionesProceso" #p="paginationApi" (pageChange)="paginaActualEjecucionesProceso = $event" class="ngx-pagination">

                <div class="custom-pagination">
                    <div class="pagination-previous" [class.disabled]="p.isFirstPage()">
                      <span *ngIf="!p.isFirstPage()" (click)="p.previous()">
                    
                          </span> 
                      </div> 
                      <div class="page-number" *ngFor="let page of p.pages" [class.current]="p.getCurrent() === page.value">
                            <span (click)="p.setCurrent(page.value)" *ngIf="p.getCurrent() !== page.value">{{ page.label }}</span>
                          <div *ngIf="p.getCurrent() === page.value">
                            <span>{{ page.label }}</span>
                          </div>
                      </div>
                      <div class="pagination-next" [class.disabled]="p.isLastPage()">
                        <span *ngIf="!p.isLastPage()" (click)="p.next()"> > </span>
                      </div>
                  </div>

            </pagination-template>
        </div>
        

      

    
    </div>

    
    <div [ngClass]="{'show-ejecuciones': mostrarEjecucionesProcesos == false, 'hide-ejecuciones': mostrarEjecucionesProcesos == true}" class="row justify-content-center .hide-div ">
        <div class="d-flex col-md-9 col-xs-9 col-sm-9 col-lg-9 mr-9 col-9 align-items-center justify-content-center" >
            <div class="show-info">
            </div>
            <span *ngIf="mostrarEjecucionesProcesos" class="show-info-button" (click)="mostrarEjecucionesProcesos = !mostrarEjecucionesProcesos">Ocultar Ejecuciones</span>
            <span *ngIf="!mostrarEjecucionesProcesos" class="show-info-button" (click)="mostrarEjecucionesProcesos = !mostrarEjecucionesProcesos">Mostrar Ejecuciones</span>
        </div>
        
    </div>

    



        <div *ngIf="AUDGENEJECUCIONPROCESO$ | async as AUDGENEJECUCIONPROCESO  " class="d-flex col-md-9 col-xs-9 col-sm-9 col-lg-9 mr-9 col-9 align-items-center justify-content-center container-progeso show-ejecuciones" style="height: 45px;" #detalleProceso>
            
            <div [ngClass]="{'step-completado': AUDGENEJECUCIONPROCESO[0]?.ETAPA != 'INICIAL', 'step-incompleto': AUDGENEJECUCIONPROCESO[0]?.ESTADO == 'FALLIDO' && AUDGENEJECUCIONPROCESO[0]?.ETAPA == 'INICIAL'}"  class="step-proceso step-proceso-enabled" style="margin-left: -0px;">
                <span >
                    <div>INICIAL</div>
                    <div class="separador-titulos"></div>
                    <div *ngIf="AUDGENEJECUCIONPROCESO[0]?.ETAPA !== 'INICIAL' ">Completado</div>
                    <div *ngIf="(AUDGENEJECUCIONPROCESO[0]?.ETAPA === 'INICIAL' && AUDGENEJECUCIONPROCESO[0]?.ESTADO_EJECUCION === 'INICIADO') ">En Proceso</div>
                    <div *ngIf="(AUDGENEJECUCIONPROCESO[0]?.ETAPA === 'INICIAL' && AUDGENEJECUCIONPROCESO[0]?.ESTADO === 'FALLIDO') ">Error</div>
                </span>
            </div>

            

            <div  [ngClass]="{'step-proceso-disabled': AUDGENEJECUCIONPROCESO[0]?.ETAPA == 'INICIAL',
                            'step-proceso-enabled': AUDGENEJECUCIONPROCESO[0]?.ETAPA == 'PROCESAMIENTO' || AUDGENEJECUCIONPROCESO[0]?.ETAPA == 'FINAL',
                            'step-completado': AUDGENEJECUCIONPROCESO[0]?.ETAPA == 'FINAL' || (AUDGENEJECUCIONPROCESO[0]?.ESTADO_EJECUCION == 'FINALIZADO' &&  AUDGENEJECUCIONPROCESO[0]?.ETAPA == 'PROCESAMIENTO') , 
                            'step-incompleto': AUDGENEJECUCIONPROCESO[0]?.ESTADO == 'FALLIDO' && AUDGENEJECUCIONPROCESO[0]?.ETAPA == 'PROCESAMIENTO'
                            }" class=" step-1-proceso">
                <span >
                    <div>PROCESAMIENTO</div>
                    <div *ngIf="AUDGENEJECUCIONPROCESO[0]?.ETAPA !== 'INICIAL'">
                        <div  class="separador-titulos"></div>
                        <div *ngIf="(AUDGENEJECUCIONPROCESO[0]?.ETAPA === 'FINAL' && AUDGENEJECUCIONPROCESO[0]?.ESTADO === 'EXITOSO') || (AUDGENEJECUCIONPROCESO[0]?.ETAPA === 'PROCESAMIENTO' && AUDGENEJECUCIONPROCESO[0]?.ESTADO === 'EXITOSO')">Completado</div>
                        <div *ngIf="(AUDGENEJECUCIONPROCESO[0]?.ETAPA === 'PROCESAMIENTO' && AUDGENEJECUCIONPROCESO[0]?.ESTADO_EJECUCION === 'INICIADO') ">En Proceso</div>
                        <div *ngIf="(AUDGENEJECUCIONPROCESO[0]?.ETAPA === 'PROCESAMIENTO' && AUDGENEJECUCIONPROCESO[0]?.ESTADO === 'FALLIDO') ">Error</div>
                    </div>
                </span>
            </div>

            

            <div  [ngClass]="{'step-proceso-disabled': AUDGENEJECUCIONPROCESO[0]?.ETAPA != 'FINAL',
                            'step-proceso-enabled': AUDGENEJECUCIONPROCESO[0]?.ETAPA === 'FINAL',
                            'step-completado-final': AUDGENEJECUCIONPROCESO[0]?.ESTADO == 'EXITOSO' && AUDGENEJECUCIONPROCESO[0]?.ETAPA == 'FINAL', 
                            'step-incompleto': AUDGENEJECUCIONPROCESO[0]?.ESTADO == 'FALLIDO' && AUDGENEJECUCIONPROCESO[0]?.ETAPA == 'FINAL'
                            }" class="step-4-proceso">
                <span >
                    <div>FINAL</div>
                    <div *ngIf="AUDGENEJECUCIONPROCESO[0]?.ETAPA === 'FINAL'">
                        <div  class="separador-titulos"></div>
                        <div *ngIf="AUDGENEJECUCIONPROCESO[0]?.ESTADO === 'EXITOSO' && AUDGENEJECUCIONPROCESO[0]?.ETAPA === 'FINAL'">Completado</div>
                        <div *ngIf="(AUDGENEJECUCIONPROCESO[0]?.ETAPA === 'FINAL' && AUDGENEJECUCIONPROCESO[0]?.ESTADO_EJECUCION === 'INICIADO') ">En Proceso</div>
                        <div *ngIf="(AUDGENEJECUCIONPROCESO[0]?.ETAPA === 'FINAL' && AUDGENEJECUCIONPROCESO[0]?.ESTADO === 'FALLIDO') ">Error</div>
                    </div>
                </span>
            </div>
        
        </div>

        
        <div class="row justify-content-center container-referencias-log"  *ngIf="AUDGENPROCESOS$ | async as AUDGENPROCESOS">
            <div class="d-flex col-md-9 col-xs-9 col-sm-9 col-lg-9 mr-9 col-9 align-items-left justify-content-left ">
                <span class="title-log-table">Monitoreo de actividades  </span>
            </div>
            <div class="d-flex col-md-9 col-xs-9 col-sm-9 col-lg-9 mr-9 col-9 align-items-center justify-content-center" *ngIf="usuario.validarRolUsuario() && rolesValids(DataUser, [Soporte])">
                <table class="listado-log" >
                    
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Tipo</th>
                            <th>Hora</th>
                            <th colspan="12" >Mensaje</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let AUDGENPROCESO of AUDGENPROCESOS | paginate: { id: 'detalleEjecucion', itemsPerPage: 10, currentPage: paginaActualProceso} ; index as i ">
                            <td>{{i + 1}}</td>
                            <td [ngClass]="{'error-log': AUDGENPROCESO.NIVEL === 'FALLIDO', 'info-log': AUDGENPROCESO.NIVEL === 'INFO' , 'debug-log': AUDGENPROCESO.NIVEL === 'DEBUG' }">{{AUDGENPROCESO.NIVEL}}</td>
                            <td >{{AUDGENPROCESO.FECHA | date :'short'}}</td>
                            <td [ngClass]="{'error-log': AUDGENPROCESO.NIVEL === 'FALLIDO'}">{{AUDGENPROCESO.MENSAJE_SOPORTE}}</td>
                        </tr>
                    </tbody>
                </table>

            </div> 
            <div class="d-flex col-md-9 col-xs-9 col-sm-9 col-lg-9 mr-9 col-9 align-items-left " >
                

            <div class="d-flex col-md-9 col-xs-9 col-sm-9 col-lg-9 mr-9 col-9 align-items-center justify-content-center" *ngIf="usuario.validarRolUsuario() && rolesValids(DataUser, [Administrador])">
                <table class="listado-log" >
                    
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Hora</th>
                            <th colspan="12" >Mensaje</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let AUDGENPROCESO of AUDGENPROCESOS | paginate: { id: 'detalleEjecucion', itemsPerPage: 10, currentPage: paginaActualProceso} ; index as i">
                            <td>{{i + 1 }}</td>
                            <td >{{AUDGENPROCESO.FECHA | date :'short'}}</td>
                            <td [ngClass]="{'error-log': AUDGENPROCESO.NIVEL === 'FALLIDO'}">{{AUDGENPROCESO.MENSAJE_NEGOCIO}}</td>
                        </tr>
                    </tbody>
                </table>
            </div> 

            <pagination-template id="detalleEjecucion" #p="paginationApi" (pageChange)="paginaActualProceso = $event" class="ngx-pagination">

                <div class="custom-pagination">
                    <div class="pagination-previous" [class.disabled]="p.isFirstPage()">
                    <span *ngIf="!p.isFirstPage()" (click)="p.previous()">
                    
                        </span> 
                    </div> 
                    <div class="page-number" *ngFor="let page of p.pages" [class.current]="p.getCurrent() === page.value">
                            <span (click)="p.setCurrent(page.value)" *ngIf="p.getCurrent() !== page.value">{{ page.label }}</span>
                        <div *ngIf="p.getCurrent() === page.value">
                            <span>{{ page.label }}</span>
                        </div>
                    </div>
                    <div class="pagination-next" [class.disabled]="p.isLastPage()">
                        <span *ngIf="!p.isLastPage()" (click)="p.next()"> > </span>
                    </div>
                </div>

            </pagination-template>
        
  
        </div>

    </div>

    
    
  
  </div>
  
  