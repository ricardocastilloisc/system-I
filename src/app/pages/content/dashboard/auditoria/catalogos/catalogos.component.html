<section *ngIf="enProceso()">
    <div class="container-fluid">
        <div class="row justify-content-center" style="height: 60vh; width: 100%">
            <div class=" align-self-center">
                <div class="d-flex flex-column" style="width: 504px;">
                    <div class="descripcionPrimerLogin" style="margin-top:34px">
                        <div class="row">
                            <div class="col-10">
                                <img src="assets/icons/ico-residencial.png" width="30%" class="center">
                                <p>Esta página se encuentra en construcción.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<section *ngIf="!enProceso()">
    <ngx-spinner bdColor = "rgba(0,0,0,0.5)" size = "default" color = "#fff" type = "ball-scale-ripple" [fullScreen] = "true"><p style="color: white" > Cargando... </p></ngx-spinner>
    <div class="card-busqueda">
        <div class="mt-4">Buscar por</div>
        <div style="
        text-align: right;
        width: 100%;
        justify-content: flex-end;
        direction: rtl;
      ">
            <div style="margin-right: 10%">
                <a (click)="limpirarFiltro()" class="limpiarFiltro">Eliminar Filtro
                  <img src="assets/icons/Eliminar.svg" class="tamanioFiltroIcono" /></a>
              </div>
        </div>
        <div name="filtros">
            <section class="mt-3">
                <div class="col2-row2">
                    <ng-multiselect-dropdown style="width: 80%; padding-left: 10px" [placeholder]="'Catálogo'"
                        id="filtroCatalogo" [settings]="SettingsFiltroDeCatalogo" [data]="dropdownListFiltroCatalogo"
                        [(ngModel)]="selectedItemsFiltroCatalogo"
                        (onSelect)="cambiarEtiquetaSeleccionadaGeneral('filtroCatalogo')">
                    </ng-multiselect-dropdown>
                </div>
                <div class="col2-row2">
                    <ng-multiselect-dropdown style="width: 80%;" [placeholder]="'Acción'" id="filtroAccion"
                        [settings]="SettingsFiltroDeAccion" [data]="dropdownListFiltroAccion"
                        [(ngModel)]="selectedItemsFiltroAccion"
                        (onSelect)="cambiarEtiquetaSeleccionadaGeneral('filtroAccion')">
                    </ng-multiselect-dropdown>
                </div>
                <div class="col2-row2">
                    <ng-multiselect-dropdown style="width: 80%; padding-left: 10px" [placeholder]="'Correo electrónico'"
                        id="filtroCorreo" [settings]="SettingsFiltroDeCorreo" [data]="dropdownListFiltroCorreo"
                        [(ngModel)]="selectedItemsFiltroCorreo"
                        (onSelect)="cambiarEtiquetaSeleccionadaGeneral('filtroCorreo')">
                    </ng-multiselect-dropdown>
                </div>
                <div class="col2-row2">
                    <input style="width: 80%; padding-left: 10px" type="date" placeholder="dd-MM-yyyy"
                        onfocus="(this.type='date')" id="fechaFiltrar"
                        name="fechaFiltrar" [value]="maxDate" max="{{ maxDate| date:'yyyy-MM-dd'}}" />
                </div>
                <div class="col2-row2">
                    <button style="cursor: pointer" (click)="filtrar()">Buscar</button>
                </div>
            </section>
        </div>
    </div>
    <div class="d-flex col-md-12 col-sm-12 col-xs-12 col-lg-12 col-xl-12 justify-content-center"
        *ngIf="ListadoPantalla as ListadoPantalla">
        <div class="card-lista-design-general" style="overflow-x: auto">
            <table class="table listado-design-general">
                <tr>
                    <th style="padding-left: 40px; max-width: 300px">Catálogo</th>
                    <th style="padding-left: 30px; max-width: 300px">Usuario</th>
                    <th style="padding-left: 30px; max-width: 150px">Fecha</th>
                    <th style="padding-left: 30px; max-width: 150px">Acción</th>
                    <th style="padding-left: 30px; max-width: 150px">Detalle</th>
                </tr>
                <tr *ngFor="let itemAuditoria of ListadoPantalla">
                    <td style="padding-left: 40px; max-width: 300px">{{itemAuditoria.CATALOGOS.DESCRIPCION}}
                    </td>
                    <td style="padding-left: 30px; max-width: 300px">{{itemAuditoria.USUARIO.NOMBRE}}
                        {{itemAuditoria.USUARIO.APELLIDO_PATERNO}}
                    </td>
                    <td style="padding-left: 30px; max-width: 150px">{{itemAuditoria.FECHA | date :'dd/MM/yyyy'}}
                        {{itemAuditoria.FECHA | date:'mediumTime'}}
                    </td>
                    <td style="padding-left: 30px; max-width: 150px">{{itemAuditoria.CATALOGOS.ACCION}}
                    </td>
                    <td style="width: 200px" class="justify-content-center">
                        <center><img style="cursor: pointer" class="detalle-icon"
                                (click)="openModal(content, itemAuditoria)" /></center>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</section>
<ng-template #content let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">
            <div>Detalle de los cambios</div>
        </h4>
        <button type="button" aria-label="Close" (click)="modal.dismiss()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="container">
            <div class="row">
                <div class="col-sm">
                    <p class="titulo">Campo</p>
                    <div *ngFor="let item of itemsValor">
                        {{item}}
                    </div>
                </div>
                <div class="col-sm">
                    <p class="titulo">Antes</p>
                    <div *ngFor="let item of itemsAntes">
                        {{item}}
                    </div>
                </div>
                <div class="col-sm">
                    <p class="titulo">Después</p>
                    <div *ngFor="let item of itemsDespues">
                        {{item}}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn bottonCerrarModal" data-dismiss="modal" (click)="modal.close()">
            Cerrar
        </button>
    </div>
</ng-template>